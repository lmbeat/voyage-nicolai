<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Objectif Voyage ‚Äì Progression</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:#0f172a;color:#f8fafc;margin:0;padding:24px
    }
    .card{
      max-width:640px;margin:0 auto;
      background:#111827;border:1px solid rgba(255,255,255,.08);
      border-radius:14px;padding:20px
    }
    h2{margin-top:0;margin-bottom:16px}
    .bar{
      position:relative;height:28px;background:#1e293b;
      border-radius:14px;overflow:hidden
    }
    .bar-fill{
      position:absolute;top:0;left:0;height:100%;
      background:linear-gradient(90deg,#22d3ee,#22c55e);
      transition:width .6s ease;border-radius:14px
    }
    .bar-label{
      position:absolute;right:8px;top:50%;transform:translateY(-50%);
      font-size:14px;font-weight:700;
      background:#bbf7d0;color:#052e13;padding:2px 6px;border-radius:8px
    }
    .footer{margin-top:16px;font-size:15px;color:#f1f5f9}
  </style>
</head>
<body>
  <div class="card">
    <h2>Progression</h2>
    <div class="bar" aria-label="Barre de progression">
      <div id="bar-fill" class="bar-fill" style="width:0%"></div>
      <div id="bar-label" class="bar-label">0%</div>
    </div>
    <div id="footer" class="footer">Chargement‚Ä¶</div>
  </div>

  <script>
    // üëâ Ton script public JSON
    const DATA_URL = "https://script.google.com/macros/s/AKfycbwiNA08Y9Q9A6SDd8qd6yyC7MvIwvN8CdNgev6oqYTqf96UgR49SdR-R3I3Hw_w655Qcw/exec";

    async function loadData(){
      try{
        const res = await fetch(DATA_URL, {cache:'no-store'});
        const data = await res.json();
        const current = Number(data.current_amount||0);
        const goal = Number(data.main_goal||1);
        const pct = Math.min(100, Math.round((current/goal)*100));

        // Mettre √† jour la barre
        document.getElementById('bar-fill').style.width = pct + '%';
        document.getElementById('bar-label').textContent = pct + '%';

        // Texte du footer
        document.getElementById('footer').textContent =
          `${current.toLocaleString('fr-FR')} ‚Ç¨ collect√©s sur ${goal.toLocaleString('fr-FR')} ‚Ç¨ (objectif principal).`;
      }catch(e){
        document.getElementById('footer').textContent = "‚ùå Erreur de chargement: " + e;
      }
    }
    loadData();
  </script>
</body>
</html>
